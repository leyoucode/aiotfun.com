<div id="reading-progress" class="fixed top-0 left-0 h-0.5 bg-accent z-60" style="width:0%;"></div>

<script>
  document.addEventListener('astro:page-load', () => {
    const bar = document.getElementById('reading-progress') as HTMLElement;
    if (!bar) return;

    const body = document.querySelector('.article-body');
    if (!body) {
      bar.style.width = '0%';
      return;
    }

    function update() {
      const rect = body!.getBoundingClientRect();
      const top = -rect.top;
      const height = rect.height - window.innerHeight;
      if (height <= 0) { bar.style.width = '100%'; return; }
      const pct = Math.min(100, Math.max(0, (top / height) * 100));
      bar.style.width = pct + '%';
    }

    window.addEventListener('scroll', update, { passive: true });
    update();
  });
</script>

<style>
  .z-60 { z-index: 60; }
</style>
