---
import BaseLayout from '../../layouts/BaseLayout.astro';
import AgentStatusBar from '../../components/AgentStatusBar.astro';
import HeroSection from '../../components/HeroSection.astro';
import DiscoveryStream from '../../components/DiscoveryStream.astro';
import WeeklyRadar from '../../components/WeeklyRadar.astro';
import AIRoundtable from '../../components/AIRoundtable.astro';
import Newsletter from '../../components/Newsletter.astro';
import { getFeaturedArticles } from '../../utils/articles';
import { optimizeImageUrl } from '../../utils/image';

const featured = await getFeaturedArticles('en');
const heroImage = featured[0]?.cover ? optimizeImageUrl(featured[0].cover, 1200, 75) : undefined;
---

<BaseLayout title="AIoTFun — Discover Fun Things in AI & IoT" preloadImage={heroImage}>
  <AgentStatusBar />
  <HeroSection />
  <DiscoveryStream />

  <!-- Weekly Radar + AI Roundtable 并排 -->
  <section class="mx-auto max-w-content px-4 py-8 md:px-6">
    <div class="grid gap-6 md:grid-cols-2">
      <WeeklyRadar />
      <AIRoundtable />
    </div>
  </section>

  <Newsletter />
</BaseLayout>
