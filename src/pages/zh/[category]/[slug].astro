---
import ArticleLayout from '../../../layouts/ArticleLayout.astro';
import { getArticles, getArticleBySlug } from '../../../data/mockArticles';
import { getArticleBody } from '../../../data/mockArticleBodies';
import type { GetStaticPaths } from 'astro';

export const getStaticPaths: GetStaticPaths = () => {
  const articles = getArticles('zh');
  return articles.map((article) => ({
    params: { category: article.category, slug: article.slug },
  }));
};

const { category, slug } = Astro.params;
const article = getArticleBySlug(slug!, 'zh');

if (!article) {
  return Astro.redirect('/zh/');
}

// 注入 body
const body = getArticleBody(slug!, 'zh');
const articleWithBody = { ...article, body };
---

<ArticleLayout article={articleWithBody} />
