---
import ArticleLayout from '../../../layouts/ArticleLayout.astro';
import { render } from 'astro:content';
import { getArticles, getArticleBySlug, getArticleEntry } from '../../../utils/articles';
import type { GetStaticPaths } from 'astro';

export const getStaticPaths: GetStaticPaths = async () => {
  const articles = await getArticles('zh');
  return articles.map((article) => ({
    params: { category: article.category, slug: article.slug },
  }));
};

const { category, slug } = Astro.params;
const article = await getArticleBySlug(slug!, 'zh');

if (!article) {
  return Astro.redirect('/zh/');
}

const entry = await getArticleEntry(slug!, 'zh');
const { Content } = await render(entry!);
---

<ArticleLayout article={article}><Content /></ArticleLayout>
